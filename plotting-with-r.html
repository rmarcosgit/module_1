<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Introduction to spatial statistics with R</title>
  <meta name="description" content="Introduction to spatial statistics with R">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Introduction to spatial statistics with R" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Introduction to spatial statistics with R" />
  
  
  

<meta name="author" content="Marcos Rodrigues">


<meta name="date" content="2017-10-27">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="basic-instructions.html">
<link rel="next" href="final-words.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-0.9/htmlwidgets.js"></script>
<script src="libs/datatables-binding-0.2/datatables.js"></script>
<link href="libs/dt-core-1.10.12/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.12/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.12/js/jquery.dataTables.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MODULE 1: Introduction to R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prologue</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> A brief introduction to R</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#what-is-r"><i class="fa fa-check"></i><b>1.1</b> What is R?</a><ul>
<li class="chapter" data-level="1.1.1" data-path="intro.html"><a href="intro.html#getting-and-installing-r"><i class="fa fa-check"></i><b>1.1.1</b> Getting and installing R</a></li>
<li class="chapter" data-level="1.1.2" data-path="intro.html"><a href="intro.html#documentation-manuals-and-help"><i class="fa fa-check"></i><b>1.1.2</b> Documentation, manuals and help</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#starting-with-r"><i class="fa fa-check"></i><b>1.2</b> Starting with R</a><ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#the-r-environment"><i class="fa fa-check"></i><b>1.2.1</b> The R environment</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#working-with-r"><i class="fa fa-check"></i><b>1.3</b> Working with R</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#objects-in-r"><i class="fa fa-check"></i><b>1.4</b> Objects in R</a><ul>
<li class="chapter" data-level="1.4.1" data-path="intro.html"><a href="intro.html#creating-objects"><i class="fa fa-check"></i><b>1.4.1</b> Creating objects</a></li>
<li class="chapter" data-level="1.4.2" data-path="intro.html"><a href="intro.html#vectors"><i class="fa fa-check"></i><b>1.4.2</b> Vectors</a></li>
<li class="chapter" data-level="1.4.3" data-path="intro.html"><a href="intro.html#lists"><i class="fa fa-check"></i><b>1.4.3</b> Lists</a></li>
<li class="chapter" data-level="1.4.4" data-path="intro.html"><a href="intro.html#arrays"><i class="fa fa-check"></i><b>1.4.4</b> Arrays</a></li>
<li class="chapter" data-level="1.4.5" data-path="intro.html"><a href="intro.html#data.frame"><i class="fa fa-check"></i><b>1.4.5</b> Data.frame</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#object-management"><i class="fa fa-check"></i><b>1.5</b> Object management</a></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#functions-and-arguments"><i class="fa fa-check"></i><b>1.6</b> Functions and arguments</a></li>
<li class="chapter" data-level="1.7" data-path="intro.html"><a href="intro.html#scripts-in-r"><i class="fa fa-check"></i><b>1.7</b> Scripts in R</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="working-with-files.html"><a href="working-with-files.html"><i class="fa fa-check"></i><b>2</b> Working with files</a><ul>
<li class="chapter" data-level="2.1" data-path="working-with-files.html"><a href="working-with-files.html#the-working-directory"><i class="fa fa-check"></i><b>2.1</b> The working directory</a></li>
<li class="chapter" data-level="2.2" data-path="working-with-files.html"><a href="working-with-files.html#reading-data-files"><i class="fa fa-check"></i><b>2.2</b> Reading data files</a></li>
<li class="chapter" data-level="2.3" data-path="working-with-files.html"><a href="working-with-files.html#writing-text-files"><i class="fa fa-check"></i><b>2.3</b> Writing text files</a></li>
<li class="chapter" data-level="2.4" data-path="working-with-files.html"><a href="working-with-files.html#data-manipulation"><i class="fa fa-check"></i><b>2.4</b> Data manipulation</a><ul>
<li class="chapter" data-level="2.4.1" data-path="working-with-files.html"><a href="working-with-files.html#working-with-columns"><i class="fa fa-check"></i><b>2.4.1</b> Working with columns</a></li>
<li class="chapter" data-level="2.4.2" data-path="working-with-files.html"><a href="working-with-files.html#working-with-rows"><i class="fa fa-check"></i><b>2.4.2</b> Working with rows</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basic-instructions.html"><a href="basic-instructions.html"><i class="fa fa-check"></i><b>3</b> Basic instructions</a><ul>
<li class="chapter" data-level="3.1" data-path="basic-instructions.html"><a href="basic-instructions.html#descriptive-statistics-and-summaries"><i class="fa fa-check"></i><b>3.1</b> Descriptive statistics and summaries</a></li>
<li class="chapter" data-level="3.2" data-path="basic-instructions.html"><a href="basic-instructions.html#the-apply-function"><i class="fa fa-check"></i><b>3.2</b> The <em>apply()</em> function</a></li>
<li class="chapter" data-level="3.3" data-path="basic-instructions.html"><a href="basic-instructions.html#installing-packages"><i class="fa fa-check"></i><b>3.3</b> Installing packages</a><ul>
<li class="chapter" data-level="3.3.1" data-path="basic-instructions.html"><a href="basic-instructions.html#installing-an-external-package"><i class="fa fa-check"></i><b>3.3.1</b> Installing an external package</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="basic-instructions.html"><a href="basic-instructions.html#create-a-function"><i class="fa fa-check"></i><b>3.4</b> Create a function</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="plotting-with-r.html"><a href="plotting-with-r.html"><i class="fa fa-check"></i><b>4</b> Plotting with R</a><ul>
<li class="chapter" data-level="4.1" data-path="plotting-with-r.html"><a href="plotting-with-r.html#basic-plots"><i class="fa fa-check"></i><b>4.1</b> Basic plots</a><ul>
<li class="chapter" data-level="4.1.1" data-path="plotting-with-r.html"><a href="plotting-with-r.html#dot-or-point-plots"><i class="fa fa-check"></i><b>4.1.1</b> Dot or point plots</a></li>
<li class="chapter" data-level="4.1.2" data-path="plotting-with-r.html"><a href="plotting-with-r.html#line-plots"><i class="fa fa-check"></i><b>4.1.2</b> Line plots</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="plotting-with-r.html"><a href="plotting-with-r.html#histograms"><i class="fa fa-check"></i><b>4.2</b> Histograms</a></li>
<li class="chapter" data-level="4.3" data-path="plotting-with-r.html"><a href="plotting-with-r.html#scatterplots"><i class="fa fa-check"></i><b>4.3</b> Scatterplots</a></li>
<li class="chapter" data-level="4.4" data-path="plotting-with-r.html"><a href="plotting-with-r.html#multiple-plots"><i class="fa fa-check"></i><b>4.4</b> Multiple plots</a><ul>
<li class="chapter" data-level="4.4.1" data-path="plotting-with-r.html"><a href="plotting-with-r.html#create-a-combined-plot"><i class="fa fa-check"></i><b>4.4.1</b> Create a combined plot</a></li>
<li class="chapter" data-level="4.4.2" data-path="plotting-with-r.html"><a href="plotting-with-r.html#export-an-image-file"><i class="fa fa-check"></i><b>4.4.2</b> Export an image file</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i>Final Words</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to spatial statistics with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="plotting-with-r" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Plotting with R</h1>
<div id="basic-plots" class="section level2">
<h2><span class="header-section-number">4.1</span> Basic plots</h2>
<p>R is not just an environment for the implementation and use of functions for statistical calculation but it is also a powerful environment for generating and displaying plots. Creating plots is besides an effective and quick way to visualize our data. By doing so we can verify whether data was correctly imported or not. However, creating graphics is also done by command-line instructions, which can sometimes be a bit tricky, especially at the beginning.</p>
<p>In R we can create many types of plots. With some packages it is also possible to generate maps similar to those created by GIS, although for the moment we will only see some basic types such as:</p>
<ul>
<li>Dot charts</li>
<li>Line charts</li>
<li>Barplots</li>
<li>Histograms</li>
<li>Scatterplots</li>
</ul>
<p>Before going into detail with the specific types of graphics we will see some general concepts which apply to the majority of plots:</p>
<ol style="list-style-type: decimal">
<li><p>All graphics always require an object that contains the data to be drawn. This object is usually specified in the first argument of the function corresponding to each type of chart.</p></li>
<li>There are a number of arguments to manipulate axis labels or the chart title:</li>
</ol>
<ul>
<li><code>main</code>: text with the title of our plot.</li>
<li><code>xlab</code>: text for x axis label.</li>
<li><code>ylab</code>: text for y axis label.</li>
<li><code>xlim</code>: vector with upper and low range for the x-axis.</li>
<li><code>ylim</code>: vector with upper and low range for the y-axis.</li>
<li><code>cex</code>: number indicating the aspect ratio between plot elements and text. 1 by default.</li>
<li><code>col</code>: changes de color the plotted element. See <a href="http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf" class="uri">http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf</a></li>
<li><code>legend()</code>: adds a legend element describing symbology.</li>
</ul>
<div id="dot-or-point-plots" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Dot or point plots</h3>
<p>This is one of the most basic types of graphics if not the most basic one we can create. To create such a graph we will use the <code>plot()</code> function. Let’s look at a simple example using data from <em>fires.csv</em><a href="#fn9" class="footnoteRef" id="fnref9"><sup>9</sup></a>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="dt">mgp=</span><span class="kw">c</span>(<span class="fl">2.4</span>, <span class="fl">0.8</span>, <span class="dv">0</span>))
<span class="kw">plot</span>(fires$SPAIN)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-69-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>As you can see, we are ploting data from the <em>SPAIN</em> column, ie, yearly fire occurrence data in Spain.</p>
<div class="note">
<p>
Remember RStudio displays plots in the right-bottom window. In addition, if you need to take closer look use the <em>Zoom</em> button to pop-up a new plot window.
</p>
</div>
<p>Le’s tune up and enhace our plot. We can change the symbol type using the <code>pch</code> argument. You’ll find a list of symbol types (not just dot charts) at <a href="http://www.statmethods.net/advgraphs/parameters.html" class="uri">http://www.statmethods.net/advgraphs/parameters.html</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="dt">mgp=</span><span class="kw">c</span>(<span class="fl">2.4</span>, <span class="fl">0.8</span>, <span class="dv">0</span>))
<span class="kw">plot</span>(fires$SPAIN,<span class="dt">pch=</span><span class="dv">4</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-71-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>We can change symbol size using <code>cex</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="dt">mgp=</span><span class="kw">c</span>(<span class="fl">2.4</span>, <span class="fl">0.8</span>, <span class="dv">0</span>))
<span class="kw">plot</span>(fires$SPAIN,<span class="dt">pch=</span><span class="dv">4</span>,<span class="dt">cex=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-72-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>And we can change the color of the symbol with `col’:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="dt">mgp=</span><span class="kw">c</span>(<span class="fl">2.4</span>, <span class="fl">0.8</span>, <span class="dv">0</span>))
<span class="kw">plot</span>(fires$SPAIN,<span class="dt">pch=</span><span class="dv">4</span>,<span class="dt">cex=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-73-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The col argument can be specified either using the color name as in the example or using its code number, hexadecimal or RGB so that <code>col = 1</code>, <code>col = &quot;white&quot;</code>, and <code>col = &quot;#FFFFFF&quot;</code> are equivalent. In some types of symbols we can also change the color of the symbol background in addition to the symbol itself using the argument <code>bg</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="dt">mgp=</span><span class="kw">c</span>(<span class="fl">2.4</span>, <span class="fl">0.8</span>, <span class="dv">0</span>))
<span class="kw">plot</span>(fires$SPAIN,<span class="dt">pch=</span><span class="dv">21</span>,<span class="dt">cex=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="st">&#39;black&#39;</span>,<span class="dt">bg=</span><span class="st">&#39;red&#39;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-74-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The finish our plot we will modify axis labels, add a title and a legend:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="dt">mgp=</span><span class="kw">c</span>(<span class="fl">2.4</span>, <span class="fl">0.8</span>, <span class="dv">0</span>))
<span class="kw">plot</span>(fires$SPAIN,<span class="dt">pch=</span><span class="dv">21</span>,<span class="dt">cex=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="st">&#39;black&#39;</span>,<span class="dt">bg=</span><span class="st">&#39;red&#39;</span>,
     <span class="dt">main=</span><span class="st">&#39;Number of fires in Spain&#39;</span>,<span class="dt">ylab =</span> <span class="st">&#39;Number of fires&#39;</span>,<span class="dt">xlab =</span> <span class="st">&#39;&#39;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-75-1.png" width="80%" style="display: block; margin: auto;" /> Note that we have used the <code>xlab</code> argument to leave the x-axis label <em>blank</em>. Now we add the legend. It is important you bear in mind that the legend is added with an additional command right after the plot statement. Legends in basic plots are just an image we add to an existing plot by emulating the symbol used in that plot using the <code>legend()</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="dt">mgp=</span><span class="kw">c</span>(<span class="fl">2.4</span>, <span class="fl">0.8</span>, <span class="dv">0</span>))
<span class="kw">plot</span>(fires$SPAIN,<span class="dt">pch=</span><span class="dv">21</span>,<span class="dt">cex=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="st">&#39;black&#39;</span>,<span class="dt">bg=</span><span class="st">&#39;red&#39;</span>,
     <span class="dt">main=</span><span class="st">&#39;Number of fires in Spain&#39;</span>,<span class="dt">ylab =</span> <span class="st">&#39;Number of fires&#39;</span>,<span class="dt">xlab =</span> <span class="st">&#39;&#39;</span>)
<span class="kw">legend</span>( <span class="st">&quot;topleft&quot;</span> , <span class="dt">cex =</span> <span class="fl">1.3</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Spain&quot;</span>), , <span class="dt">text.col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>) , <span class="dt">pt.bg =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>) , <span class="dt">pch =</span> <span class="kw">c</span>(<span class="dv">21</span>) )</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-76-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>But, what if we want to add a second series of data? Then we proceed in a way similar to the <code>legend()</code> statement, but using the function <code>points()</code> similar to what we have seen in the <code>plot()</code> example. In the following code we add a second point data series with portugal:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="dt">mgp=</span><span class="kw">c</span>(<span class="fl">2.4</span>, <span class="fl">0.8</span>, <span class="dv">0</span>))
<span class="kw">plot</span>(fires$SPAIN,<span class="dt">pch=</span><span class="dv">21</span>,<span class="dt">cex=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="st">&#39;black&#39;</span>,<span class="dt">bg=</span><span class="st">&#39;red&#39;</span>,
     <span class="dt">main=</span><span class="st">&#39;Number of fires in Spain&#39;</span>,<span class="dt">ylab =</span> <span class="st">&#39;Number of fires&#39;</span>,<span class="dt">xlab =</span> <span class="st">&#39;&#39;</span>)
<span class="kw">points</span>(fires$PORTUGAL,<span class="dt">pch=</span><span class="dv">21</span>,<span class="dt">cex=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">bg=</span><span class="st">&quot;blue&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-77-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Finally, we update the legend to fit the new plot with the second series of data. To do that we simply include a second value on each argument using a vector:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="dt">mgp=</span><span class="kw">c</span>(<span class="fl">2.4</span>, <span class="fl">0.8</span>, <span class="dv">0</span>))
<span class="kw">plot</span>(fires$SPAIN,<span class="dt">pch=</span><span class="dv">21</span>,<span class="dt">cex=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="st">&#39;black&#39;</span>,<span class="dt">bg=</span><span class="st">&#39;red&#39;</span>,
     <span class="dt">main=</span><span class="st">&#39;Number of fires in Spain&#39;</span>,<span class="dt">ylab =</span> <span class="st">&#39;Number of fires&#39;</span>,<span class="dt">xlab =</span> <span class="st">&#39;&#39;</span>)
<span class="kw">points</span>(fires$PORTUGAL,<span class="dt">pch=</span><span class="dv">21</span>,<span class="dt">cex=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">bg=</span><span class="st">&quot;blue&quot;</span>)
<span class="kw">legend</span>( <span class="st">&quot;topleft&quot;</span> , <span class="dt">cex =</span> <span class="fl">1.3</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Spain&quot;</span>,<span class="st">&quot;Portugal&quot;</span>), , <span class="dt">text.col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>) , <span class="dt">pt.bg =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>) , <span class="dt">pch =</span> <span class="kw">c</span>(<span class="dv">21</span>) )</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-78-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The problem we are now experiencing is that data for Portugal doesn’t fit in the extent of the plot as it is. We should modify this using the <code>xlim</code> and <code>ylim</code> arguments. At this point x-axis works fine, so we’ll leave it as it is. The problem comes from y-axis. We can solve it by passing the <code>ylim</code> argument passing the minimum and maximum values of the <code>fires</code> data. We bring here some functions from <a href="basic-instructions.html#descriptive-statistics-and-summaries">Descriptive statistics and summaries</a>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="dt">mgp=</span><span class="kw">c</span>(<span class="fl">2.4</span>, <span class="fl">0.8</span>, <span class="dv">0</span>))
<span class="kw">plot</span>(fires$SPAIN,<span class="dt">pch=</span><span class="dv">21</span>,<span class="dt">cex=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="st">&#39;black&#39;</span>,<span class="dt">bg=</span><span class="st">&#39;red&#39;</span>,
     <span class="dt">main=</span><span class="st">&#39;Number of fires in Spain&#39;</span>,<span class="dt">ylab =</span> <span class="st">&#39;Number of fires&#39;</span>,<span class="dt">xlab =</span> <span class="st">&#39;&#39;</span>,
     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="kw">min</span>(fires[,<span class="dv">2</span>:<span class="dv">6</span>]),<span class="kw">max</span>(fires[,<span class="dv">2</span>:<span class="dv">6</span>])))
     
<span class="kw">points</span>(fires$PORTUGAL,<span class="dt">pch=</span><span class="dv">21</span>,<span class="dt">cex=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">bg=</span><span class="st">&quot;blue&quot;</span>)
<span class="kw">legend</span>( <span class="st">&quot;topleft&quot;</span> , <span class="dt">cex =</span> <span class="fl">1.3</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Spain&quot;</span>,<span class="st">&quot;Portugal&quot;</span>), , <span class="dt">text.col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>) , <span class="dt">pt.bg =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>) , <span class="dt">pch =</span> <span class="kw">c</span>(<span class="dv">21</span>) )</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-79-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="exer">
<p>
<strong>EXERCISE 3</strong>:
</p>
<p>
Explain in detail how the statement <code>ylim = c(min(fires[,2:6]),max(fires[,2:6]))</code> works in terms of the <code>max()</code> and <code>min()</code> functions and its interaction with the <code>fires</code>object.
</p>
</div>
</div>
<div id="line-plots" class="section level3">
<h3><span class="header-section-number">4.1.2</span> Line plots</h3>
<p>Well, this is quite easy. In line plots we use lines to represent our data series instead of points which are the default symbol. How do we do that? Just adding an additionla argument to specify we want to use lines with <code>type = 'l'</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="dt">mgp=</span><span class="kw">c</span>(<span class="fl">2.4</span>, <span class="fl">0.8</span>, <span class="dv">0</span>))
<span class="kw">plot</span>(fires$SPAIN,<span class="dt">pch=</span><span class="dv">4</span>,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-81-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Of course we can change the line <a href="http://www.statmethods.net/advgraphs/parameters.html">style</a>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="dt">mgp=</span><span class="kw">c</span>(<span class="fl">2.4</span>, <span class="fl">0.8</span>, <span class="dv">0</span>))
<span class="kw">plot</span>(fires$SPAIN,<span class="dt">pch=</span><span class="dv">4</span>,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>, <span class="dt">lty=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-82-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Adding a second (or third, fourth,…,<span class="math inline">\(n\)</span>) series is done with <code>lines()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="dt">mgp=</span><span class="kw">c</span>(<span class="fl">2.4</span>, <span class="fl">0.8</span>, <span class="dv">0</span>))
<span class="kw">plot</span>(fires$SPAIN,<span class="dt">pch=</span><span class="dv">4</span>,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>,
     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="kw">min</span>(fires[,<span class="dv">2</span>:<span class="dv">6</span>]),<span class="kw">max</span>(fires[,<span class="dv">2</span>:<span class="dv">6</span>])))
<span class="kw">lines</span>(fires$PORTUGAL,<span class="dt">cex=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">lty=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-83-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>We now adapt the legend and add some titles and we are good to go:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="dt">mgp=</span><span class="kw">c</span>(<span class="fl">2.4</span>, <span class="fl">0.8</span>, <span class="dv">0</span>))
<span class="kw">plot</span>(fires$SPAIN,<span class="dt">pch=</span><span class="dv">4</span>,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>,
     <span class="dt">main=</span><span class="st">&#39;Number of fires in Spain&#39;</span>,<span class="dt">ylab =</span> <span class="st">&#39;Number of fires&#39;</span>,<span class="dt">xlab =</span> <span class="st">&#39;&#39;</span>,
     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="kw">min</span>(fires[,<span class="dv">2</span>:<span class="dv">6</span>]),<span class="kw">max</span>(fires[,<span class="dv">2</span>:<span class="dv">6</span>])))
<span class="kw">lines</span>(fires$PORTUGAL,<span class="dt">cex=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">lty=</span><span class="dv">2</span>)

<span class="kw">legend</span>( <span class="st">&quot;topleft&quot;</span> , <span class="dt">cex =</span> <span class="fl">1.3</span>, , <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Spain&quot;</span>,<span class="st">&quot;Portugal&quot;</span>), <span class="dt">text.col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-84-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="histograms" class="section level2">
<h2><span class="header-section-number">4.2</span> Histograms</h2>
<p>The next type of chart we will see is the frequency histogram. It is a bar chart that represents the number of elements of a sample (frequency) that we find within a certain range of values.</p>
<p>To draw this type of plot R uses the function <code>hist()</code>, which requires as a mandatory argument a vector (or column/row of an array) with the data to be represented. As with all other chart types we have seen, we can use <code>main,</code> <code>xlab</code>… Let’s see at an example using the example data from the <em>regression.txt</em> file<a href="#fn10" class="footnoteRef" id="fnref10"><sup>10</sup></a>(See Table <a href="plotting-with-r.html#fig:table3">4.1</a>):</p>
<div class="figure"><span id="fig:table3"></span>
<div id="htmlwidget-ebfad3480b7c3d8f8025" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-ebfad3480b7c3d8f8025">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234"],[20.3,23.8,24.4,20.1,20.3,21.9,24.4,20.9,21.2,24,26.8,28.1,26.5,26.9,27.4,26.8,27.3,23.1,26,20.4,23,24.3,22.6,22.9,20.7,18.2,29.3,26.3,21.8,26.1,22.2,27.1,26.1,25.4,26.8,25.6,27.8,20.3,26.5,24.6,26,23.2,18.4,20.9,24.2,23.3,25.2,26.9,20.4,21.1,21.8,22.8,23.7,21.9,23.8,24.1,24,21,22.1,22.4,22,24.2,24.6,19.7,23.3,21.4,24.2,23.2,19.3,21.4,24,23.7,24.7,25.1,23.2,23.1,24,25.4,21.6,21,21,23.1,22,24,21.9,23.4,23.7,21.1,23,18.8,19,23.2,24.9,25.1,25.5,25.6,24.9,25.6,22.8,25.3,24.9,25.9,24.4,25.2,25.1,26.3,22.8,26.8,28.1,22.3,26.3,26.9,26.7,27.9,25,23.2,25.4,25,23.8,21.9,21.5,22,25.5,27.1,23.2,23.9,25.9,25.5,25.2,28.2,23.7,27.9,28.4,21.1,21.7,24.7,22.7,24.3,21.3,23.8,23.5,26.4,25.6,26,25.8,24.9,26.5,26.9,26.1,27.1,25.8,27.5,27.3,27.1,27.7,22.1,21.7,24.8,23.7,23,25.4,27,29.1,28,22.5,21.5,22.1,22.2,18.8,25.2,26.9,26.2,29.5,28.5,27.7,27.6,30.5,29.4,29.3,28.4,23,26.2,26,25.8,25.9,21.2,28.5,26.8,26.2,27.8,27.2,28.1,28.4,24,29,26.6,25.8,27.8,25.4,27.7,26.6,26.9,21.8,27.2,24.7,25.5,27.8,28,27.3,26.5,27.9,27.6,28.6,28,28.3,25.4,24.4,25.5,27.3,25.9,28.4,26.9,29.6,25,29.3,27.2,28.9,27.7,29.3,19.9,23,23.9,24.4,22.4],[14.55,16.1,18.15,14.05,13.85,16.2,17.35,15.45,15.2,17.3,19.8,21.65,20.7,21.6,22.05,22.75,21.95,18.55,21,14.15,16.35,16.9,17.45,17.05,15.2,14.45,21.5,21.45,16,20.7,16.65,22.5,21.6,21.35,21.7,21.1,22.75,15.25,20.75,18.7,20.05,18.1,13.9,16,17.95,18.25,19.3,20.15,15.35,15.1,16.2,15.55,16.15,15.2,16.8,17.3,16.35,14.5,15,16.45,17.35,18.35,18.45,15.35,17.95,17.05,17.7,17.15,14.15,15.9,17.05,17.6,18.8,19.25,17.85,17.25,19.1,19.65,15.55,15.8,15.85,17,17.2,18.2,17.05,17.85,17.9,16.3,17.7,15,14.7,18.65,19,19.9,19.45,19.5,18.9,19.55,16.95,19.55,19.65,19.55,18.5,19.45,19.3,20.65,16.75,20.7,22.05,16.7,18.65,20.45,20.7,21.5,17.8,16.35,18.7,18,17.45,16.65,15.85,15.8,18.85,19.35,18.1,18,19.55,19.85,18.8,21.9,16.8,22.15,22.15,14.7,15.05,17.5,16.2,16,16.55,16.6,17.2,20.7,19.35,19.05,19.5,18.6,19.85,20.1,19.85,20.6,20.3,20.55,20.9,20.55,20.9,16.15,16.4,19.6,17.25,17,19,20.65,22.3,20.6,17.9,15.6,17.1,17.05,14.45,17.45,19.9,19.9,23.5,22.3,20.15,18.8,23.45,21.2,22.1,21.75,15.45,18.15,19,19.2,18.45,15.2,20.6,19.7,20,21.25,20.4,20.9,21.4,17.15,21.65,20.25,19.5,20.45,18.85,20.7,20.05,19.9,15.05,20.4,18.7,19.45,20.35,20.95,20,20.2,21,19.8,21.1,20.9,21.7,18.9,18.8,19.75,20.8,19.75,22.15,20.8,23.35,19.15,22.95,21.3,21.65,22.75,23.2,13.95,16.1,17.3,16.25,16.3],[614350,593950,567250,609150,629450,666750,659450,654050,666850,654150,668050,671750,727150,735350,735350,738650,743350,728850,750750,681950,680050,682450,686050,699550,704450,702350,714950,735750,732850,751050,737450,754850,766550,772450,774150,788050,791050,767550,790450,566050,578050,575150,568050,581950,574850,575250,584350,594750,703150,703250,701750,700350,704650,700750,701250,700950,693750,694750,669450,667650,649850,648350,646350,641750,633350,626950,637450,643150,646650,655550,654250,634950,641850,634350,622950,611050,610650,611050,620550,620550,622050,616650,622150,611350,620250,607450,598750,566850,595450,593350,589650,596850,596350,599250,606450,600050,606450,600050,574850,594550,600950,603250,605750,608550,608550,628750,600250,622050,631850,669950,642250,643350,627150,644150,574950,614350,601550,601450,644950,646350,620750,666150,633450,619550,600550,648050,636650,640150,657550,665850,660050,675250,676550,719950,719650,719950,723450,723250,698550,702750,686050,685250,690550,690950,684050,695850,692650,699550,698050,685550,677250,682050,707750,715150,701950,670350,660450,678650,681350,686250,693950,708850,714550,714950,720250,685750,708750,745250,738450,717850,749650,740550,748050,748350,755450,805350,796950,802150,807950,798050,763350,758750,760550,763950,760350,790750,775350,790450,771250,755150,759250,757850,761850,779550,764050,762950,748450,738150,724850,736350,736350,721150,711050,715350,712450,704650,718550,726850,721850,721850,732050,743750,781050,773150,780050,765050,758850,758950,763750,778850,779150,786150,796250,806850,799250,812450,814450,813650,794450,817550,619450,631650,626550,620150],[305753,271251,279823,319257,306673,317312,335694,347119,359349,369714,398728,402740,421822,425054,425054,414343,412801,405732,408039,332530,343668,374395,364932,363062,358716,381123,381190,394184,349952,388380,389140,407282,393532,388679,380209,376458,366962,340220,364794,79245,101727,70507,51076,57307,76584,88890,89365,118062,126920,127168,129987,130734,135971,132841,136787,137274,128954,124660,92720,93705,98424,99094,100043,66466,75356,76553,84209,82210,73096,82872,93670,94392,118343,100644,90978,83017,94892,110912,52280,52280,56364,59436,77137,66134,69377,51479,58747,43783,45142,54551,50846,71817,91605,102210,123809,124672,123809,124672,134948,137488,132472,125740,155086,150883,150883,154307,162508,167966,163916,132084,127156,158066,176676,171488,220931,245808,225940,217704,321170,294051,281585,293600,247638,209348,190862,227572,212133,207704,206815,199569,235313,206211,206702,140885,143390,148049,160019,166439,142067,150688,141714,145704,154563,154092,167048,153735,170184,181122,201545,188039,194717,200282,217590,225827,228112,258064,244919,245946,292842,292450,278711,271712,269211,264702,289323,305529,318825,336752,345740,299409,303295,292482,279850,280515,260316,246847,257694,273818,285549,292280,184588,192612,198661,202936,208432,211460,220446,231784,217740,211716,218774,219974,226380,234857,231833,232507,217315,206805,187935,223578,223578,189330,163711,180922,189156,188980,199613,206713,216580,216580,228736,231343,247955,242353,273227,322405,325086,313935,298726,322308,297121,311692,308132,304141,314116,316865,332049,334792,343039,231591,258238,263710,266989,270064],[152147,183121,204123,150357,138390,103530,102739,101473,85698,91221,71861,67917,12440,4242,4242,7045,4143,18170,1700,84895,82444,66619,68622,59927,56815,48958,39560,18878,43355,8516,19863,854,670,1969,4428,761,3661,32376,5437,304122,281338,302263,320160,306223,298700,290962,283908,259546,228384,228076,222813,220955,216107,218307,213368,212626,220341,226290,256766,254860,248652,248179,247609,280540,271987,271955,263327,264708,274001,264544,253093,254717,232976,249610,261159,272327,264194,253368,294909,294909,290961,289022,272524,284916,279581,298037,296149,325945,307830,302179,306646,287924,274649,266059,248195,252029,248195,252029,266723,249215,247043,249200,231788,231747,231747,215642,232762,213217,208199,215065,226013,204203,205230,195728,224503,180184,201356,206678,119986,130174,156050,117083,166640,198883,221589,168473,183161,181753,168308,166119,155758,156532,155464,220932,216190,208828,193523,184706,206090,197161,205085,201075,192219,192676,181324,193209,177086,166149,149029,163653,162437,156383,133337,124455,128382,137661,151554,136687,108647,106010,110788,103878,99872,101190,89030,97986,76361,46505,43302,84274,61370,71717,72492,71926,86479,133965,105571,86089,74079,57854,194118,172360,164064,160416,148728,183239,143219,141049,143626,140809,133594,131333,124947,124636,118972,117662,131189,140905,159580,123220,123220,157736,184103,166127,157612,158277,147162,140122,130722,130722,118324,115634,106867,109762,74558,45153,46663,51333,52849,32095,49647,35232,38906,47326,32893,34076,15730,12314,15891,194923,169248,157542,159171,162237],[4489750,4522150,4512650,4475450,4491350,4489850,4468550,4455350,4446050,4432150,4405650,4402450,4399450,4399050,4399050,4411850,4415450,4417250,4423850,4478450,4466250,4434950,4445850,4452050,4458350,4433950,4438250,4432450,4479550,4445650,4438650,4426550,4447650,4456350,4467050,4479950,4493350,4509850,4495550,4713350,4690950,4722050,4741450,4736150,4715950,4703650,4704050,4676750,4735950,4735650,4728550,4725450,4722450,4722550,4716950,4715850,4720250,4728150,4747650,4743950,4722050,4720150,4717650,4756350,4738650,4732950,4730750,4737350,4751850,4746850,4731350,4716850,4693050,4709150,4714050,4717750,4705150,4688650,4757850,4757850,4753950,4746650,4729250,4736050,4737150,4750450,4739350,4748850,4752550,4742450,4745050,4725350,4704350,4694150,4673750,4671150,4673750,4671150,4657550,4656950,4663350,4670850,4641250,4646250,4646250,4648550,4632550,4632350,4639450,4695050,4683250,4649750,4624850,4635650,4571550,4550450,4568550,4576850,4479850,4508150,4515250,4514350,4552750,4588750,4603850,4577850,4590650,4596250,4602950,4614250,4573550,4611350,4611450,4736750,4731250,4723050,4707450,4697050,4706150,4698150,4695250,4689550,4682450,4683350,4662250,4687750,4664450,4655950,4630150,4638050,4625350,4621650,4617350,4612350,4601050,4553050,4563550,4569250,4520050,4522250,4540150,4554950,4560850,4566250,4541050,4508150,4502850,4500650,4486950,4528450,4542250,4549250,4569350,4568750,4598950,4673150,4642950,4624150,4613050,4593350,4725550,4700950,4692750,4690150,4676050,4720850,4675950,4677850,4674950,4664750,4658750,4655450,4650350,4657750,4644750,4642650,4649650,4654350,4667750,4630650,4630650,4662550,4688050,4668650,4655650,4649950,4647150,4644650,4628350,4628350,4620850,4626650,4639350,4639050,4602650,4529550,4522250,4535650,4557250,4539050,4570750,4557750,4570450,4585350,4565150,4573150,4554550,4550250,4524750,4734950,4538750,4535750,4531250,4526850],[1423,1100,1229,1610,1402,1022,882,828,1308,1186,589,522,119,22,22,80,21,816,24,1353,1146,1026,993,959,1335,1294,417,193,1134,247,261,2,35,13,158,20,87,1149,111,436,282,517,866,804,575,410,427,284,1214,1183,946,889,893,874,807,802,1017,989,774,700,718,485,437,724,507,631,456,583,1027,708,641,527,478,429,608,519,371,292,621,621,552,508,549,444,580,526,522,500,485,888,876,327,301,279,261,281,261,281,711,412,346,283,459,391,391,227,794,432,275,754,427,281,434,211,744,1107,730,610,1013,1300,1188,1243,757,428,863,595,384,345,597,231,618,207,208,1335,1053,846,863,769,892,681,513,482,550,558,384,775,379,360,387,264,243,217,379,382,152,840,857,551,949,947,578,311,278,213,603,1266,1092,1021,1220,653,456,309,132,145,267,516,339,198,186,281,1082,516,530,502,566,1585,490,640,598,432,328,336,324,745,247,237,465,381,541,244,244,532,1022,437,360,363,305,379,370,370,320,239,309,276,134,471,714,524,296,504,184,443,30,494,33,361,224,296,55,1161,1016,1024,1003,1129]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>TavgMAX<\/th>\n      <th>Tavg<\/th>\n      <th>long<\/th>\n      <th>d_atl<\/th>\n      <th>d_medit<\/th>\n      <th>lat<\/th>\n      <th>elevation<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 4.1: Structure of the regression.txt file.
</p>
</div>
<ul>
<li>Tavg_max: maximum average temperture in June.</li>
<li>Tavg: average temperture in June.</li>
<li>long: longitude in UTM values EPSG:23030.</li>
<li>lot: latitude in UTM values EPSG:23030.</li>
<li>d_atl: distance in meters to the Atlantic sea.</li>
<li>d_medit: distance in meters to the Mediterranean sea.</li>
<li>elevation: elevation above sea level in meters.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(regression$elevation)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-85-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Then we use the arguments we have seen to customize the plot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(regression$elevation,<span class="dt">breaks=</span><span class="dv">15</span>,<span class="dt">main=</span><span class="st">&quot;Elevation frecuency distribution&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;Elevation&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Frecuency&quot;</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">border=</span><span class="st">&quot;white&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">40</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2000</span>))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-86-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The only new parameters are:</p>
<ul>
<li><code>breaks</code>, used to specify the number of bars in the <code>histrogram</code>.</li>
<li><code>border</code>, used the change the color of bar’s borders.</li>
</ul>
</div>
<div id="scatterplots" class="section level2">
<h2><span class="header-section-number">4.3</span> Scatterplots</h2>
<p>So far we have seen how to construct univariate graphs, ie, represent a single variable or data series. Next we will see a type of bivariate graph, the scatterplot. This type of chart is interesting to visualize relations between two variables, almost mandatory to explore correlation or collinearity in regression analysis. Let’s look at an example with our fire data.</p>
<p>In this case we introduce in the function <code>plot()</code> a second data argument (<span class="math inline">\(y\)</span>) with a second vector with the data right after the first data argument (<span class="math inline">\(x\)</span>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(regression$Tavg,regression$elevation)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-87-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Note that the first data series goes to <span class="math inline">\(x-axis\)</span> and the second to the <span class="math inline">\(y\)</span>. Again, we can customize the appearnce and symbols similar to the regural do plot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(regression$elevation, regression$Tavg,
     <span class="dt">main=</span><span class="st">&#39;Average temperature vs elevation&#39;</span>,<span class="dt">ylab =</span> <span class="st">&#39;Temperature (Celsius)&#39;</span>, <span class="dt">xlab =</span> <span class="st">&#39;Elevation (m)&#39;</span>,
     <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">col=</span><span class="st">&#39;black&#39;</span>, <span class="dt">bg=</span><span class="st">&#39;steelblue&#39;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-88-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>A particularly useful function in combination with <code>scatterplots</code> is <code>abline()</code> which allows to incorporate a <em>trend line</em> to the plot. We will further explore this later.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(regression$elevation, regression$Tavg,
     <span class="dt">main=</span><span class="st">&#39;Average temperature vs elevation&#39;</span>,<span class="dt">ylab =</span> <span class="st">&#39;Temperature (Celsius)&#39;</span>, <span class="dt">xlab =</span> <span class="st">&#39;Elevation (m)&#39;</span>,
     <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">col=</span><span class="st">&#39;black&#39;</span>, <span class="dt">bg=</span><span class="st">&#39;steelblue&#39;</span>)
<span class="kw">abline</span>(<span class="kw">lm</span>(regression$Tavg~regression$elevation), <span class="dt">lty=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&#39;gray20&#39;</span>,<span class="dt">lwd=</span><span class="dv">3</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-89-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="note">
<p>
Pay attention to the order in which I have introduced the <span class="math inline"><em>x</em></span> and <span class="math inline"><em>y</em></span> data in <code>plot()</code> and <code>abline()</code>. It is the opposite!!.
</p>
</div>
</div>
<div id="multiple-plots" class="section level2">
<h2><span class="header-section-number">4.4</span> Multiple plots</h2>
<p>To finish with plot creation we will see two last possibilities. The first one is how to combine several charts in a single figure and the second how to export an image file from our graphics.</p>
<div id="create-a-combined-plot" class="section level3">
<h3><span class="header-section-number">4.4.1</span> Create a combined plot</h3>
<p>Combining several graphs in R is possible thanks to the function <code>par(mfrow = c(rows, columns))</code>. Using this function we prepare the display window to include several graphs simultaneously:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>),<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="dt">mgp=</span><span class="kw">c</span>(<span class="fl">2.4</span>, <span class="fl">0.8</span>, <span class="dv">0</span>))
<span class="kw">plot</span>(fires$SPAIN,<span class="dt">pch=</span><span class="dv">4</span>,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>,
     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="kw">min</span>(fires[,<span class="dv">2</span>:<span class="dv">6</span>]),<span class="kw">max</span>(fires[,<span class="dv">2</span>:<span class="dv">6</span>])))
<span class="kw">plot</span>(fires$PORTUGAL,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">lty=</span><span class="dv">2</span>,
     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="kw">min</span>(fires[,<span class="dv">2</span>:<span class="dv">6</span>]),<span class="kw">max</span>(fires[,<span class="dv">2</span>:<span class="dv">6</span>])))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-91-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="export-an-image-file" class="section level3">
<h3><span class="header-section-number">4.4.2</span> Export an image file</h3>
<p>Since R runs on so many different operating systems, and supports so many different graphics formats, it’s not surprising that there are a variety of ways of saving your plots, depending on what operating system you are using, what you plan to do with the graph, and whether you’re connecting locally or remotely.</p>
<p>The first step in deciding how to save plots is to decide on the output format that you want to use. The following table lists some of the available formats, along with guidance as to when they may be useful.</p>
<p>Here’s a general method<a href="#fn11" class="footnoteRef" id="fnref11"><sup>11</sup></a> that will work on any computer with R, regardless of operating system or the way that you are connecting.</p>
<ol style="list-style-type: decimal">
<li><p>Choose the format that you want to use. In this example, I’ll save a plot as a JPG file, so I’ll use the jpeg driver.</p></li>
<li><p>The only argument that the device drivers need is the name of the file that you will use to save your graph. Remember that your plot will be stored relative to the current directory. You can find the current directory by typing <code>getwd()</code> at the R prompt. You may want to make adjustments to the size of the plot before saving it. Consult the help file for your selected driver to learn how.</p></li>
<li><p>Now enter your plotting commands as you normally would. You will not actually see the plot - the commands are being saved to a file instead.</p></li>
<li><p>When you’re done with your plotting commands, enter the <code>dev.off()</code> command. This is very important - without it you’ll get a partial plot or nothing at all. So if I wanted to save a jpg file called “rplot.jpg” containing a plot of x and y, I would type the following commands:</p></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">jpeg</span>(<span class="st">&#39;rplot.jpg&#39;</span>, <span class="dt">width =</span> <span class="dv">800</span>, <span class="dt">height =</span> <span class="dv">600</span>, <span class="dt">res=</span><span class="dv">100</span>)

<span class="co"># Here goes the plot</span>
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>),<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="dt">mgp=</span><span class="kw">c</span>(<span class="fl">2.4</span>, <span class="fl">0.8</span>, <span class="dv">0</span>))
<span class="kw">plot</span>(fires$SPAIN,<span class="dt">pch=</span><span class="dv">4</span>,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>,
     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="kw">min</span>(fires[,<span class="dv">2</span>:<span class="dv">6</span>]),<span class="kw">max</span>(fires[,<span class="dv">2</span>:<span class="dv">6</span>])))
<span class="kw">plot</span>(fires$PORTUGAL,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">lty=</span><span class="dv">2</span>,
     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="kw">min</span>(fires[,<span class="dv">2</span>:<span class="dv">6</span>]),<span class="kw">max</span>(fires[,<span class="dv">2</span>:<span class="dv">6</span>])))

<span class="kw">dev.off</span>()</code></pre></div>
<pre><code>## png 
##   2</code></pre>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="9">
<li id="fn9"><p>please, ignore the <code>par()</code> statement at this time<a href="plotting-with-r.html#fnref9">↩</a></p></li>
<li id="fn10"><p>Remember to import the file properly, setting the adequate parameters for field and decimal separator.<a href="plotting-with-r.html#fnref10">↩</a></p></li>
<li id="fn11"><p>Taken from <a href="https://www.stat.berkeley.edu/classes/s133/saving.html" class="uri">https://www.stat.berkeley.edu/classes/s133/saving.html</a><a href="plotting-with-r.html#fnref11">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="basic-instructions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="final-words.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-plots.Rmd",
"text": "Edit"
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
